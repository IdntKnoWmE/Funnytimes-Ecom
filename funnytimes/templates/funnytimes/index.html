
{% extends 'funnytimes/common.html' %}

  {% block title %} Funny Times :) {% endblock %}

  {% load static %}

  {% block css %}
    .carimg{
      width:100%;
      height: 300px;
      object-fit: contain;
      
    }

  {% endblock %}


  {% block body %}
    <div class="container-fluid">

      <!-- Carousul -->

      <div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-indicators">
          <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
          <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1" aria-label="Slide 2"></button>
          <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2" aria-label="Slide 3"></button>
        </div>
        <div class="carousel-inner">
          <div class="carousel-item active">
            <div class="d-flex">
              <img src="{% static 'funnytimes/laptop.jpg' %}" class="d-block img-fluid carimg" alt="...">
            </div> 
          </div>

          <div class="carousel-item">
            <div class="d-flex">
              <img src="{% static 'funnytimes/mobile.jpg' %}" class="d-block img-fluid carimg" alt="...">
              </div> 
          </div>

          <div class="carousel-item">
            <div class="d-flex">
              <img src="{% static 'funnytimes/furniture.jpg' %}" class="d-block img-fluid carimg" alt="...">
            </div> 
          </div>

        </div>

        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>

        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
    
    
    <!-- Container end here -->
    </div>
    <br>
    <h1 class="alert alert-success text-center">Popular Items</h1>
    <div class="container m-8 text-center">
      <div class="row align-center m-0">
        {% for i in products %}
        <div class="col-sm-4 p-2">
          <div class="cardd">
            <a href="productview/{{i.product_id}}"><img src="/media/{{i.image}}" class="cardd-img-top" style="width: 100%;height: 400px; object-fit: contain;" alt="..."></a>
            <div class="cardd-body p-1 mt-1" style="background-color: rgb(235, 214, 214);">
            <a href="productview/{{i.product_id}}"><h5 class="cardd-title">{{i.product_name}}</h5></a>
              <p class="cardd-text"  >
                {% load custom_tags %}
                {% for x in i.description|split:';'|slice:':2' %}
                <p style="color: green; font-weight: 600;">{{x}}</p>
                {% endfor %}
                

              </p>
              <p class="text text-success fw-bold"> Price : Rs {{i.prod_price}}</p>
              <button id="pr{{i.product_id}}" class="btn btn-primary cart">Add to Cart</button>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
      
  {% endblock %}

  {% block js %}
    <script>
      console.log("working");
      if(localStorage.getItem('cart') == null){
        var cart = {};
      }
      else{
        cart = JSON.parse(localStorage.getItem('cart'));
        document.getElementById('cart').innerHTML = Object.keys(cart).length;
      }
      $ ('.cart').click(function(){
        console.log("clicked");
        var idstr = this.id.toString();
        if(cart[idstr]!=undefined){
          cart[idstr] = cart[idstr]+1;
        }
        else{
          cart[idstr] = 1;
        }
        console.log(cart);
        localStorage.setItem('cart',JSON.stringify(cart));
        document.getElementById('cart').innerHTML = Object.keys(cart).length;
      });
    </script>
  {% endblock %}